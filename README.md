## Техническое задание № 2 (Т32)
![Java CI with Maven](https://github.com/KateNikonorova/NumbersCICD/actions/workflows/maven.yml/badge.svg)
### Описание проекта:
#### Задачи:
1. Реализовать простейшую программу на Java, которая будет считывать из файла числа, 
   а далее отдельными функциями искать среди этих чисел минимальное число, максимальное число, 
   считать их общую сумму и произведение.

   Функции называются, соответственно _min (минимальное число), _max (максимальное число), 
   _sum (сумма всех чисел), _mult (произведение всех чисел).
2. Реализовать тесты для проверки корректной работы функций программы
3. Реализовать тесты для проверки скорости работы программы при увеличении размера входного файла.


### 1. Реализация функции чтения из файла, поиска минимального, максимального числа, сложения и умножения всех чисел из файла
*NumbersCICD* - программа считывающая из файла числа, записанные через пробел, и вычисляет минимальное число, максимальное, сумму и произведение.

Файл считывает функция readFile класса NumberCalc, в функцию можно передавать строку с названием файла, либо объект класса File.
В классе NumberCalc реализованы методы _min, _max, _sum, _mult, которые возвращают соответсвующие результаты.
Метод main класса App читает файл с указанным названием (в примере "input.txt") и вычисляет минимум, максимум, сумму и произведение.

[//]: # (![image]&#40;https://github.com/KateNikonorova/NumbersCICD/assets/167033338/a2b099f1-04b1-4d02-819b-b8e90579ac93&#41;)

Код представлен в файле *NumbersCICD/src/main/java/org/example/NumberCalc.java*  
[NumberCalc.java](https://github.com/KateNikonorova/NumbersCICD/blob/main/src/main/java/org/example/NumberCalc.java) 

### 2. Реализация тестов для проверки корректности функций поиска минимума, максимума, сложения и умножения
Реализованы 4 unit теста для проверки кооректной работы функций min, max, sum, mult. Тесты написаны в файле *NumbersCICD/src/test/java/org/example/AppTest.java* [AppTest.java](https://github.com/KateNikonorova/NumbersCICD/blob/main/src/test/java/org/example/AppTest.java). 
Для тестов берутся заранее подготовленные файлы *test<Number>.txt* с номерами 1-5 из каталога test/resources.

### 3. Реализация тестов для проверки скорости работы программы при увеличении размера входного файла
В файле *NumbersCICD/src/test/java/org/example/SpeedCheckGenerator.java* [SpeedCheckGenerator.java](https://github.com/KateNikonorova/NumbersCICD/blob/main/src/test/java/org/example/SpeedCheckGenerator.java) написан генератор текстовых файлов для нагрузочного тестирования. 

В файле *NumbersCICD/src/test/java/org/example/AppTestBenchmarks.java* [AppTestBenchmarks.java](https://github.com/KateNikonorova/NumbersCICD/blob/main/src/test/java/org/example/AppTestBenchmarks.java) написан код для нагрузочного тестирования. 
Были созданы файлы в каталоге test с количеством чисел от 100_000 до 1_000_000 с шагом в 100_000, они называются в формате *speedCheck<Number>* с номерами 1-10. Для каждого из файлов запускалось нагрузочное тестирование, результатом которого было среднее время работы программы на всех тестах. Среднее время записано в файле с кодом для графика 
[plot.ipynb](https://github.com/KateNikonorova/NumbersCICD/blob/main/plot.ipynb). Затем был построен график.

### 4. Реализация теста на мой выбор
В файл с тестами *NumbersCICD/src/test/java/org/example/AppTest.java* был добавлен сценарный тест *readFileTest*, в котором тестируется корректность чтения информации из текстовых файлов, проверяется сколько чисел считалось из файла и не пустой ли массив чисел после чтения.

### 5. Построить график зависимости времени выполнения функции _max от кол-ва чисел в файле
График построен в пункте 3 [chart.png](https://github.com/KateNikonorova/NumbersCICD/blob/main/output.png). 
Он был построен с помощью библиотек seaborn, matplotlib, pandas. В файле output.png отражена искомая зависимость (практически линейная). 
По оси x расположено количество чисел в файле в тысячах, по оси y - секунды.

### 6. Загрузить в репозиторий файлы проекта
Файлы проекта (код, тесты,  README.md и тд) были загружены в данный репозиторий с помощью функций git commit, git push примененных для проекта, созданного в Intellij IDEA.

### 7. Подключить к проекту CI систему, обеспечить возможность проведения ручного тестирования
CI система была реализована с помощью инструментов github actions. Реализована возможность ручного прогона тестов для выбранного коммита на основе Maven архитектуры. Для этого:

1. Перейти во вкладку Actions
2. Выбрать интересующий коммит и кликнуть на него
3. Навести курсор на нужную сборку в левой части экрана, перезапустить сборку (re-run jobs)
4. Сборка будет пересобрана и запустится прогон тестов
5. Лог сборки можно посмотреть, кликнув на сборку (Находится в списке jobs)

Например, в разделе Run tests каждой сборки можно увидеть прошла ли программа все тесты или были какие-то ошибки
![image](https://github.com/KateNikonorova/NumbersCICD/assets/167033338/524062c6-1a85-46b3-9dd7-3c3e268ebf3e)

### 8. Настроить автоматический прогон тестов при каждом коммите
В файле *maven.yml*, где написан код для запуска тестов, указано условие (on: push), что обеспечивает прогон тестов при каждом pushе из Intellij IDEA или при каждом коммите внутри гитхаба.
Чтобы увидеть статус после нового коммита или пул реквеста нужно:

1. Нажать на значок вверху страницы рядом с именем владельца репозитория и последнем коммитом
2. Значок может значить следующее:

Зеленая галочка - сборка прошла успешно, все тесты пройдены

Желтый кружочек - тестирование происходит в данный момент

Красный крестик - ошибка при сборке

### 9. Сделать бейдж, отражающий текущий статус тестов
(Бейдж представлен в начале README)

### 10. Интеграция CI в telegram
Был создан чатбот в телеграмме, который с помощью соответствующего кода в файле *maven.yml*, отправляет сообщение в группу в телеграмме (https://t.me/+Xphb7gf9t981YzUy) о статусе пройденных тестов: "Все ОК", если тесты прошли успешно или "Проект завершился с ошибкой. Лог тестирования:..."
![image](https://github.com/KateNikonorova/NumbersCICD/assets/167033338/cbe37b50-503e-42e6-b25a-9c53c399d2b2)
